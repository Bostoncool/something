Data folder paths:
Meteorological data directory: C:\Users\IU\Desktop\Datebase Origin\ERA5-Beijing-CSV
Pollution data directory: C:\Users\IU\Desktop\Datebase Origin\Benchmark\all(AQI+PM2.5+PM10)
Extra pollution data directory: C:\Users\IU\Desktop\Datebase Origin\Benchmark\extra(SO2+NO2+CO+O3)
Beijing Meteorological Factors and Pollution Change Spearman Correlation Analysis
============================================================
Starting to load data...
Loading meteorological data...
Found 2280 meteorological data files
Using 16 processes
Meteorological data loading completed, time taken: 37.17 seconds
Successfully loaded data from 2160 files
Loading pollution data...
Found 3646 pollution data files
Error loading file C:\Users\IU\Desktop\Datebase Origin\Benchmark\all(AQI+PM2.5+PM10)\beijing_20160101-20161231\beijing_all_20161230.csv: No columns to parse from file
Error loading file C:\Users\IU\Desktop\Datebase Origin\Benchmark\all(AQI+PM2.5+PM10)\beijing_20160101-20161231\beijing_all_20161231.csv: No columns to parse from file
Pollution data loading completed, time taken: 21.31 seconds
Successfully loaded data from 3627 files
Loading extra pollution data...
Found 3646 extra pollution data files
Error loading file C:\Users\IU\Desktop\Datebase Origin\Benchmark\extra(SO2+NO2+CO+O3)\beijing_20160101-20161231\beijing_extra_20161230.csv: No columns to parse from file
Error loading file C:\Users\IU\Desktop\Datebase Origin\Benchmark\extra(SO2+NO2+CO+O3)\beijing_20160101-20161231\beijing_extra_20161231.csv: No columns to parse from file
Extra pollution data loading completed, time taken: 24.05 seconds
Successfully loaded data from 3627 files
Data loading completed!
Preparing combined data...
Meteorological data shape: (2160, 74)
Pollution data shape: (3627, 6)
Extra pollution data shape: (3627, 8)
Aligned length: 2160
Combined data shape: (2160, 88)
Final data shape: (2160, 88)
Number of meteorological parameters: 72
Number of pollution parameters: 14
Number of wind component parameters: 16
Wind component parameters: ['v100_mean', 'v100_std', 'v100_min', 'v100_max', 'u100_mean', 'u100_std', 'u100_min', 'u100_max', 'u10_mean', 'u10_std', 'u10_min', 'u10_max', 'v10_mean', 'v10_std', 'v10_min', 'v10_max']
Analyzing correlations...
Calculating Spearman correlation using PyTorch...

Correlation analysis between meteorological factors and pollution indicators:
Found 14 pollution indicators and 72 meteorological factors

Meteorological factors most correlated with pm25_mean:
  avg_tprate_min: 0.500
  sd_min: 0.500
  lsm_max: 0.500
  cvh_max: 0.500
  tisr_min: 0.500

Meteorological factors most correlated with pm10_mean:
  avg_tprate_min: 0.500
  sd_min: 0.500
  lsm_max: 0.500
  cvh_max: 0.500
  tisr_min: 0.500

Meteorological factors most correlated with aqi_mean:
  avg_tprate_min: 0.500
  sd_min: 0.500
  lsm_max: 0.500
  cvh_max: 0.500
  tisr_min: 0.500

Meteorological factors most correlated with pm25_max:
  avg_tprate_min: 0.500
  sd_min: 0.500
  lsm_max: 0.500
  cvh_max: 0.500
  tisr_min: 0.500

Meteorological factors most correlated with pm10_max:
  avg_tprate_min: 0.500
  sd_min: 0.500
  lsm_max: 0.500
  cvh_max: 0.500
  tisr_min: 0.500

Meteorological factors most correlated with aqi_max:
  avg_tprate_min: 0.500
  sd_min: 0.500
  lsm_max: 0.500
  cvh_max: 0.500
  tisr_min: 0.500

Meteorological factors most correlated with so2_mean:
  avg_tprate_min: 0.500
  sd_min: 0.500
  lsm_max: 0.500
  cvh_max: 0.500
  tisr_min: 0.500

Meteorological factors most correlated with co_mean:
  avg_tprate_min: 0.500
  sd_min: 0.500
  lsm_max: 0.500
  cvh_max: 0.500
  tisr_min: 0.500

Meteorological factors most correlated with o3_mean:
  avg_tprate_min: 0.500
  sd_min: 0.500
  lsm_max: 0.500
  cvh_max: 0.500
  tisr_min: 0.500

Meteorological factors most correlated with no2_mean:
  avg_tprate_min: 0.500
  sd_min: 0.500
  lsm_max: 0.500
  cvh_max: 0.500
  tisr_min: 0.500

Meteorological factors most correlated with so2_max:
  avg_tprate_min: 0.500
  sd_min: 0.500
  lsm_max: 0.500
  cvh_max: 0.500
  tisr_min: 0.500

Meteorological factors most correlated with co_max:
  avg_tprate_min: 0.500
  sd_min: 0.500
  lsm_max: 0.500
  cvh_max: 0.500
  tisr_min: 0.500

Meteorological factors most correlated with o3_max:
  avg_tprate_min: 0.500
  sd_min: 0.500
  lsm_max: 0.500
  cvh_max: 0.500
  tisr_min: 0.500

Meteorological factors most correlated with no2_max:
  avg_tprate_min: 0.500
  sd_min: 0.500
  lsm_max: 0.500
  cvh_max: 0.500
  tisr_min: 0.500
Correlation heatmap saved to: beijing_spearman_correlation_heatmap.png
Top N strongest correlations plot saved to: beijing_spearman_top_correlations.png

================================================================================
Beijing Meteorological Factors and Pollution Change Spearman Correlation Analysis Report
================================================================================

1. Data Overview:
   - Data shape: (2160, 88)
   - Number of samples: 2160

2. Feature Classification:
   - Number of meteorological factors: 72
   - Number of pollution indicators: 14

3. Meteorological Factors Details:
   - str_mean
   - str_std
   - str_min
   - str_max
   - tcwv_mean
   - tcwv_std
   - tcwv_min
   - tcwv_max
   - v100_mean
   - v100_std
   ... and 62 more meteorological factors

4. Pollution Indicators Details:
   - pm25_mean
   - pm10_mean
   - aqi_mean
   - pm25_max
   - pm10_max
   - aqi_max
   - so2_mean
   - co_mean
   - o3_mean
   - no2_mean
   - so2_max
   - co_max
   - o3_max
   - no2_max

5. Spearman Correlation Analysis:
Meteorological factors most correlated with pollution indicators:
   pm25_mean:
     - avg_tprate_min: 0.500
     - sd_min: 0.500
     - lsm_max: 0.500
   pm10_mean:
     - avg_tprate_min: 0.500
     - sd_min: 0.500
     - lsm_max: 0.500
   aqi_mean:
     - avg_tprate_min: 0.500
     - sd_min: 0.500
     - lsm_max: 0.500
   pm25_max:
     - avg_tprate_min: 0.500
     - sd_min: 0.500
     - lsm_max: 0.500
   pm10_max:
     - avg_tprate_min: 0.500
     - sd_min: 0.500
     - lsm_max: 0.500
   aqi_max:
     - avg_tprate_min: 0.500
     - sd_min: 0.500
     - lsm_max: 0.500
   so2_mean:
     - avg_tprate_min: 0.500
     - sd_min: 0.500
     - lsm_max: 0.500
   co_mean:
     - avg_tprate_min: 0.500
     - sd_min: 0.500
     - lsm_max: 0.500
   o3_mean:
     - avg_tprate_min: 0.500
     - sd_min: 0.500
     - lsm_max: 0.500
   no2_mean:
     - avg_tprate_min: 0.500
     - sd_min: 0.500
     - lsm_max: 0.500
   so2_max:
     - avg_tprate_min: 0.500
     - sd_min: 0.500
     - lsm_max: 0.500
   co_max:
     - avg_tprate_min: 0.500
     - sd_min: 0.500
     - lsm_max: 0.500
   o3_max:
     - avg_tprate_min: 0.500
     - sd_min: 0.500
     - lsm_max: 0.500
   no2_max:
     - avg_tprate_min: 0.500
     - sd_min: 0.500
     - lsm_max: 0.500

6. Strongest Spearman Correlation Analysis:
Top 10 strongest Spearman correlations:
   1. avg_tprate_min vs sd_min: 1.000
   2. avg_tprate_min vs lsm_max: 1.000
   3. avg_tprate_min vs cvh_max: 1.000
   4. avg_tprate_min vs tisr_min: 1.000
   5. avg_tprate_min vs cvl_min: 1.000
   6. sd_min vs lsm_max: 1.000
   7. sd_min vs cvh_max: 1.000
   8. sd_min vs tisr_min: 1.000
   9. sd_min vs cvl_min: 1.000
   10. lsm_max vs cvh_max: 1.000

7. Key Findings:
   - Temperature, humidity, wind speed and other meteorological factors have comprehensive effects on pollution levels
   - Boundary layer height and atmospheric stability are important influencing factors
   - Precipitation and wind speed have significant effects on pollutant dispersion
   - Multi-meteorological factor comprehensive analysis can better explain pollution changes
   - Spearman correlation provides rank-based correlation analysis, robust to outliers