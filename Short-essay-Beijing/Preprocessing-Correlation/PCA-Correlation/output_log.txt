成功加载了 3627 个文件的数据
数据加载完成！
准备合并数据...
原始气象数据形状: (2160, 74)
原始污染数据形状: (3627, 6)
原始额外污染数据形状: (3627, 8)
对齐长度: 2160
合并后数据形状: (2160, 88)
最终数据形状: (2160, 88)
合并后的列名: ['mn2t_mean', 'mn2t_std', 'mn2t_min', 'mn2t_max', 'year', 'month', 'tcwv_mean', 'tcwv_std', 'tcwv_min', 'tcwv_max', 'avg_tprate_mean', 'avg_tprate_std', 'avg_tprate_min', 'avg_tprate_max', 'sp_mean', 'sp_std', 'sp_min', 'sp_max', 'd2m_mean', 'd2m_std', 'd2m_min', 'd2m_max', 'cvl_mean', 'cvl_std', 'cvl_min', 'cvl_max', 'cvh_mean', 'cvh_std', 'cvh_min', 'cvh_max', 'sd_mean', 'sd_std', 'sd_min', 'sd_max', 'lsm_mean', 'lsm_std', 'lsm_min', 'lsm_max', 'str_mean', 'str_std', 'str_min', 'str_max', 'tisr_mean', 'tisr_std', 'tisr_min', 'tisr_max', 'v10_mean', 'v10_std', 'v10_min', 'v10_max', 't2m_mean', 't2m_std', 't2m_min', 't2m_max', 'u100_mean', 'u100_std', 'u100_min', 'u100_max', 'tp_mean', 'tp_std', 'tp_min', 'tp_max', 'u10_mean', 'u10_std', 'u10_min', 'u10_max', 'v100_mean', 'v100_std', 'v100_min', 'v100_max', 'blh_mean', 'blh_std', 'blh_min', 'blh_max', 'pm25_mean', 'pm10_mean', 'aqi_mean', 'pm25_max', 'pm10_max', 'aqi_max', 'so2_mean', 'co_mean', 'o3_mean', 'no2_mean', 'so2_max', 'co_max', 'o3_max', 'no2_max']
最终NaN数量: 0
气象参数数量: 72
气象参数列表: ['mn2t_mean', 'mn2t_std', 'mn2t_min', 'mn2t_max', 'tcwv_mean', 'tcwv_std', 'tcwv_min', 'tcwv_max', 'avg_tprate_mean', 'avg_tprate_std']...        
风分量参数数量: 16
风分量参数列表: ['v10_mean', 'v10_std', 'v10_min', 'v10_max', 'u100_mean', 'u100_std', 'u100_min', 'u100_max', 'u10_mean', 'u10_std', 'u10_min', 'u10_max', 'v100_mean', 'v100_std', 'v100_min', 'v100_max']
污染参数数量: 14
污染参数列表: ['pm25_mean', 'pm10_mean', 'aqi_mean', 'pm25_max', 'pm10_max', 'aqi_max', 'so2_mean', 'co_mean', 'o3_mean', 'no2_mean', 'so2_max', 'co_max', 'o3_max', 'no2_max']
执行PCA分析...
前 2 个主成分的方差解释率:
PC1: 0.1148 (11.48%)
累积: 0.1148 (11.48%)
PC2: 0.0692 (6.92%)
累积: 0.1839 (18.39%)

主成分贡献分析:

PC1 主要贡献特征（前5个）:
  aqi_max: 0.2925
  pm25_mean: 0.2912
  co_mean: 0.2903
  aqi_mean: 0.2778
  no2_mean: 0.2736

PC2 主要贡献特征（前5个）:
  mn2t_min: 0.2884
  mn2t_mean: 0.2880
  mn2t_max: 0.2654
  avg_tprate_mean: -0.2006
  avg_tprate_std: -0.1974
分析相关性...

气象因子与污染指标相关性分析:
发现 14 个污染指标和 72 个气象因子

与 pm25_mean 最相关的气象因子:
  u10_std: 0.174
  tcwv_std: 0.152
  tcwv_max: 0.148
  tcwv_mean: 0.137
  tcwv_min: 0.131

与 pm10_mean 最相关的气象因子:
  u10_std: 0.169
  tcwv_std: 0.152
  tcwv_max: 0.141
  u10_max: 0.126
  tcwv_mean: 0.125

与 aqi_mean 最相关的气象因子:
  u10_std: 0.178
  tcwv_std: 0.153
  tcwv_max: 0.143
  u10_max: 0.133
  tcwv_mean: 0.129

与 pm25_max 最相关的气象因子:
  u10_std: 0.178
  tcwv_std: 0.166
  tcwv_max: 0.160
  tcwv_mean: 0.155
  tcwv_min: 0.148

与 pm10_max 最相关的气象因子:
  u10_std: 0.185
  tcwv_std: 0.148
  tcwv_max: 0.147
  tcwv_mean: 0.126
  u10_max: 0.120

与 aqi_max 最相关的气象因子:
  u10_std: 0.193
  tcwv_std: 0.187
  tcwv_max: 0.185
  tcwv_mean: 0.165
  sp_std: 0.162

与 so2_mean 最相关的气象因子:
  str_max: 0.226
  u100_mean: 0.220
  tcwv_min: 0.184
  sp_std: 0.183
  tcwv_max: 0.183

与 co_mean 最相关的气象因子:
  tcwv_std: 0.179
  tcwv_max: 0.178
  u10_std: 0.172
  tcwv_mean: 0.165
  tcwv_min: 0.153

与 o3_mean 最相关的气象因子:
  sd_max: 0.175
  v10_mean: 0.175
  sd_std: 0.169
  cvl_std: 0.165
  cvl_max: 0.165

与 no2_mean 最相关的气象因子:
  sp_std: 0.159
  tcwv_std: 0.135
  tcwv_max: 0.135
  str_std: 0.130
  u10_std: 0.130

与 so2_max 最相关的气象因子:
  str_max: 0.257
  tcwv_std: 0.200
  tcwv_max: 0.199
  u100_mean: 0.197
  sp_std: 0.195

与 co_max 最相关的气象因子:
  str_max: 0.210
  tcwv_max: 0.210
  tcwv_std: 0.199
  tcwv_mean: 0.187
  tcwv_min: 0.165

与 o3_max 最相关的气象因子:
  tisr_mean: 0.168
  v10_mean: 0.166
  tisr_std: 0.165
  blh_max: 0.159
  cvl_max: 0.155

与 no2_max 最相关的气象因子:
  tcwv_max: 0.187
  u10_std: 0.186
  tcwv_std: 0.182
  tcwv_mean: 0.174
  tcwv_min: 0.158
Correlation heatmap saved to: beijing_correlation_heatmap_optimized.png
PCA results plot saved to: beijing_pca_results_optimized.png

================================================================================
北京多气象因子对污染变化影响的PCA分析报告（优化版）
================================================================================

1. 数据概览:
   - 数据形状: (2160, 88)
   - 特征数量: 86
   - 样本数量: 2160

2. 特征分类:
   - 气象因子数量: 72
   - 污染指标数量: 14

3. 气象因子详情:
   - mn2t_mean
   - mn2t_std
   - mn2t_min
   - mn2t_max
   - tcwv_mean
   - tcwv_std
   - tcwv_min
   - tcwv_max
   - avg_tprate_mean
   - avg_tprate_std
   ... 还有 62 个气象因子

4. 污染指标详情:
   - pm25_mean
   - pm10_mean
   - aqi_mean
   - pm25_max
   - pm10_max
   - aqi_max
   - so2_mean
   - co_mean
   - o3_mean
   - no2_mean
   - so2_max
   - co_max
   - o3_max
   - no2_max

5. 相关性分析:
   与污染指标最相关的气象因子:
   pm25_mean:
     - u10_std: 0.174
     - tcwv_std: 0.152
     - tcwv_max: 0.148
   pm10_mean:
     - u10_std: 0.169
     - tcwv_std: 0.152
     - tcwv_max: 0.141
   aqi_mean:
     - u10_std: 0.178
     - tcwv_std: 0.153
     - tcwv_max: 0.143
   pm25_max:
     - u10_std: 0.178
     - tcwv_std: 0.166
     - tcwv_max: 0.160
   pm10_max:
     - u10_std: 0.185
     - tcwv_std: 0.148
     - tcwv_max: 0.147
   aqi_max:
     - u10_std: 0.193
     - tcwv_std: 0.187
     - tcwv_max: 0.185
   so2_mean:
     - str_max: 0.226
     - u100_mean: 0.220
     - tcwv_min: 0.184
   co_mean:
     - tcwv_std: 0.179
     - tcwv_max: 0.178
     - u10_std: 0.172
   o3_mean:
     - sd_max: 0.175
     - v10_mean: 0.175
     - sd_std: 0.169
   no2_mean:
     - sp_std: 0.159
     - tcwv_std: 0.135
     - tcwv_max: 0.135
   so2_max:
     - str_max: 0.257
     - tcwv_std: 0.200
     - tcwv_max: 0.199
   co_max:
     - str_max: 0.210
     - tcwv_max: 0.210
     - tcwv_std: 0.199
   o3_max:
     - tisr_mean: 0.168
     - v10_mean: 0.166
     - tisr_std: 0.165
   no2_max:
     - tcwv_max: 0.187
     - u10_std: 0.186
     - tcwv_std: 0.182

6. PCA分析结果:
   - 主成分数量: 2
   - PC1 方差解释率: 0.1148 (11.48%)
   - PC2 方差解释率: 0.0692 (6.92%)
   - 累积方差解释率: 0.1839 (18.39%)

7. 主成分物理意义分析:
   PC1 主要贡献特征（前5个）:
     - aqi_max: 0.2925
     - pm25_mean: 0.2912
     - co_mean: 0.2903
     - aqi_mean: 0.2778
     - no2_mean: 0.2736
   PC2 主要贡献特征（前5个）:
     - mn2t_min: 0.2884
     - mn2t_mean: 0.2880
     - mn2t_max: 0.2654
     - avg_tprate_mean: -0.2006
     - avg_tprate_std: -0.1974

8. 主要发现:
   - 多气象因子综合分析能更好解释污染变化
   - 温度、湿度、风速等因素对污染水平有综合影响
   - 边界层高度和大气稳定性是重要影响因素
   - 降水和风速对污染物扩散有显著影响