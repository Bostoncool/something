最终数据形状: (2160, 88)
合并后的列名: ['tp_mean', 'tp_std', 'tp_min', 'tp_max', 'year', 'month', 'mn2t_mean', 'mn2t_std', 'mn2t_min', 'mn2t_max', 'avg_tprate_mean', 'avg_tprate_std', 'avg_tprate_min', 'avg_tprate_max', 'cvl_mean', 'cvl_std', 'cvl_min', 'cvl_max', 'blh_mean', 'blh_std', 'blh_min', 'blh_max', 'u100_mean', 'u100_std', 'u100_min', 'u100_max', 'v100_mean', 'v100_std', 'v100_min', 'v100_max', 'u10_mean', 'u10_std', 'u10_min', 'u10_max', 'tisr_mean', 'tisr_std', 'tisr_min', 'tisr_max', 'v10_mean', 'v10_std', 'v10_min', 'v10_max', 'cvh_mean', 'cvh_std', 'cvh_min', 'cvh_max', 'str_mean', 'str_std', 'str_min', 'str_max', 'd2m_mean', 'd2m_std', 'd2m_min', 'd2m_max', 'tcwv_mean', 'tcwv_std', 'tcwv_min', 'tcwv_max', 'sd_mean', 'sd_std', 'sd_min', 'sd_max', 'lsm_mean', 'lsm_std', 'lsm_min', 'lsm_max', 'sp_mean', 'sp_std', 'sp_min', 'sp_max', 't2m_mean', 't2m_std', 't2m_min', 't2m_max', 'pm25_mean', 'pm10_mean', 'aqi_mean', 'pm25_max', 'pm10_max', 'aqi_max', 'so2_mean', 'co_mean', 'o3_mean', 'no2_mean', 'so2_max', 'co_max', 'o3_max', 'no2_max']
气象参数数量: 72
气象参数列表: ['tp_mean', 'tp_std', 'tp_min', 'tp_max', 'mn2t_mean', 'mn2t_std', 'mn2t_min', 'mn2t_max', 'avg_tprate_mean', 'avg_tprate_std']...
风分量参数数量: 16
风分量参数列表: ['u100_mean', 'u100_std', 'u100_min', 'u100_max', 'v100_mean', 'v100_std', 'v100_min', 'v100_max', 'u10_mean', 'u10_std', 'u10_min', 'u10_max', 'v10_mean', 'v10_std', 'v10_min', 'v10_max']
污染参数数量: 14
污染参数列表: ['pm25_mean', 'pm10_mean', 'aqi_mean', 'pm25_max', 'pm10_max', 'aqi_max', 'so2_mean', 'co_mean', 'o3_mean', 'no2_mean', 'so2_max', 'co_max', 'o3_max', 'no2_max']
执行Kendall相关性分析...
计算Kendall相关系数...
Kendall相关矩阵形状: (86, 86)
分析Kendall相关性...

气象因子与污染指标之间的Kendall相关性分析:
找到 14 个污染指标和 72 个气象因子

与 pm25_mean 最相关的气象因子 (Kendall):
  d2m_min: 0.102
  d2m_max: 0.098
  d2m_mean: 0.090
  d2m_std: 0.067
  str_mean: 0.059

与 pm10_mean 最相关的气象因子 (Kendall):
  d2m_max: 0.077
  v100_min: 0.075
  t2m_mean: 0.074
  v100_std: 0.074
  d2m_min: 0.069

与 aqi_mean 最相关的气象因子 (Kendall):
  d2m_max: 0.095
  d2m_min: 0.093
  d2m_mean: 0.087
  v100_min: 0.075
  v100_std: 0.072

与 pm25_max 最相关的气象因子 (Kendall):
  d2m_min: 0.119
  d2m_max: 0.112
  d2m_mean: 0.104
  t2m_mean: 0.077
  str_mean: 0.077

与 pm10_max 最相关的气象因子 (Kendall):
  t2m_mean: 0.093
  lsm_min: 0.087
  t2m_min: 0.086
  lsm_mean: 0.082
  lsm_std: 0.082

与 aqi_max 最相关的气象因子 (Kendall):
  d2m_min: 0.105
  d2m_max: 0.103
  d2m_mean: 0.092
  t2m_mean: 0.082
  lsm_min: 0.080

与 so2_mean 最相关的气象因子 (Kendall):
  lsm_min: 0.190
  t2m_mean: 0.173
  d2m_min: 0.165
  d2m_max: 0.162
  t2m_min: 0.159

与 co_mean 最相关的气象因子 (Kendall):
  d2m_min: 0.106
  d2m_max: 0.103
  d2m_mean: 0.094
  t2m_mean: 0.089
  t2m_max: 0.082

与 o3_mean 最相关的气象因子 (Kendall):
  t2m_mean: 0.167
  t2m_max: 0.153
  t2m_min: 0.142
  avg_tprate_max: 0.141
  cvh_mean: 0.125

与 no2_mean 最相关的气象因子 (Kendall):
  t2m_mean: 0.141
  t2m_max: 0.121
  t2m_min: 0.117
  lsm_min: 0.096
  u10_std: 0.092

与 so2_max 最相关的气象因子 (Kendall):
  lsm_min: 0.185
  t2m_mean: 0.174
  d2m_max: 0.172
  d2m_min: 0.169
  d2m_mean: 0.160

与 co_max 最相关的气象因子 (Kendall):
  d2m_min: 0.129
  lsm_min: 0.121
  d2m_max: 0.119
  t2m_mean: 0.116
  d2m_mean: 0.113

与 o3_max 最相关的气象因子 (Kendall):
  cvh_mean: 0.148
  t2m_mean: 0.147
  cvh_min: 0.144
  avg_tprate_max: 0.138
  t2m_max: 0.135

与 no2_max 最相关的气象因子 (Kendall):
  d2m_max: 0.141
  d2m_min: 0.138
  d2m_mean: 0.130
  t2m_mean: 0.110
  str_mean: 0.108
Kendall correlation heatmap saved to: beijing_kendall_correlation_heatmap.png
Kendall statistics plot saved to: beijing_kendall_statistics.png

================================================================================
北京多气象因子对污染变化的Kendall相关性分析报告
污染指标: PM2.5, PM10, AQI, SO2, CO, O3, NO2
================================================================================

1. 数据概览:
   - 数据形状: (2160, 88)
   - 特征数量: 86
   - 样本数量: 2160

2. 特征分类:
   - 气象因子数量: 72
   - 污染指标数量: 14

3. 气象因子详情:
   - tp_mean
   - tp_std
   - tp_min
   - tp_max
   - mn2t_mean
   - mn2t_std
   - mn2t_min
   - mn2t_max
   - avg_tprate_mean
   - avg_tprate_std
   ... 还有 62 个气象因子

4. 污染指标详情:
   - pm25_mean
   - pm10_mean
   - aqi_mean
   - pm25_max
   - pm10_max
   - aqi_max
   - so2_mean
   - co_mean
   - o3_mean
   - no2_mean
   - so2_max
   - co_max
   - o3_max
   - no2_max

5. Kendall相关性分析:
   - 计算的相关性总数: 6400
   - 平均相关系数: 0.0315
   - 标准差: 0.1802
   - 强相关性 (|r| > 0.3): 332
   - 中等相关性 (0.1 < |r| <= 0.3): 746
   与污染指标最相关的气象因子:
   pm25_mean:
     - d2m_min: 0.102
     - d2m_max: 0.098
     - d2m_mean: 0.090
   pm10_mean:
     - d2m_max: 0.077
     - v100_min: 0.075
     - t2m_mean: 0.074
   aqi_mean:
     - d2m_max: 0.095
     - d2m_min: 0.093
     - d2m_mean: 0.087
   pm25_max:
     - d2m_min: 0.119
     - d2m_max: 0.112
     - d2m_mean: 0.104
   pm10_max:
     - t2m_mean: 0.093
     - lsm_min: 0.087
     - t2m_min: 0.086
   aqi_max:
     - d2m_min: 0.105
     - d2m_max: 0.103
     - d2m_mean: 0.092
   so2_mean:
     - lsm_min: 0.190
     - t2m_mean: 0.173
     - d2m_min: 0.165
   co_mean:
     - d2m_min: 0.106
     - d2m_max: 0.103
     - d2m_mean: 0.094
   o3_mean:
     - t2m_mean: 0.167
     - t2m_max: 0.153
     - t2m_min: 0.142
   no2_mean:
     - t2m_mean: 0.141
     - t2m_max: 0.121
     - t2m_min: 0.117
   so2_max:
     - lsm_min: 0.185
     - t2m_mean: 0.174
     - d2m_max: 0.172
   co_max:
     - d2m_min: 0.129
     - lsm_min: 0.121
     - d2m_max: 0.119
   o3_max:
     - cvh_mean: 0.148
     - t2m_mean: 0.147
     - cvh_min: 0.144
   no2_max:
     - d2m_max: 0.141
     - d2m_min: 0.138
     - d2m_mean: 0.130

6. 统计显著性分析:
   - P值总数: 6184
   - α = 0.05 水平显著: 4044 (65.4%)
   - α = 0.01 水平显著: 3424 (55.4%)
   - α = 0.001 水平显著: 2762 (44.7%)

7. 主要发现:
   - Kendall相关性分析揭示了变量间的非参数关系
   - 温度、湿度和风因子与污染水平存在显著相关性
   - 边界层高度和大气稳定性是关键影响因素
   - 降水和风速对污染物扩散有显著影响
   - 非参数分析相比Pearson相关性对异常值更加稳健

================================================================================