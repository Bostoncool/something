# 快速开始指南 - 5分钟上手

## 🚀 最快方式（推荐）

### 1. 安装依赖（1分钟）

```bash
pip install pandas numpy matplotlib seaborn scikit-learn scipy pygam
```

> 💡 如果pygam安装失败，可以跳过，程序会自动跳过GAM模型

### 2. 运行简化版脚本（1分钟）

```bash
cd Short-Essay-Beijing/MachineLearning
python MLR_GAM_Simple.py
```

### 3. 查看结果（3分钟）

程序运行完成后，会生成以下文件：

**图表文件（重要）：**
1. `simple_prediction_scatter.png` - 📊 预测效果一目了然
2. `simple_timeseries.png` - 📈 时间序列预测曲线
3. `simple_model_comparison.png` - 🏆 模型性能对比
4. `simple_feature_importance.png` - 🔍 特征重要性排名
5. `simple_residuals.png` - 📉 残差分析

**数据文件：**
- `simple_model_performance.csv` - 模型评分表
- `simple_coefficients.csv` - 回归系数

## 📊 预期结果

运行后，你会看到类似这样的输出：

```
================================================================================
北京PM2.5浓度预测 - 简化版线性基线模型
================================================================================

1. 数据准备
--------------------------------------------------------------------------------
生成模拟数据...
数据形状: (2000, 12)
时间范围: 2015-01-01 至 2020-06-18

2. 特征和目标分离
--------------------------------------------------------------------------------
特征数量: 11
特征列表: ['d2m', 't2m', 'wind_speed_10m', 'tcwv', 'tp', 'blh', ...]

3. 数据集划分
--------------------------------------------------------------------------------
训练集: 1600 样本 (80.0%)
测试集: 400 样本 (20.0%)

4. 模型训练
--------------------------------------------------------------------------------
4.1 多元线性回归 (MLR)
4.2 Ridge回归
4.3 Lasso回归
4.4 广义加性模型 (GAM)

5. 模型评估
--------------------------------------------------------------------------------
模型性能对比:
 Model   Set      R²     RMSE     MAE
   MLR Train  0.8503   8.2156  6.0987
   MLR  Test  0.8467   8.4821  6.2344
 Ridge Train  0.8503   8.2157  6.0988
 Ridge  Test  0.8466   8.4828  6.2349
...

测试集性能排名:
 Model      R²     RMSE     MAE
   GAM  0.8721   7.7543  5.7821
   MLR  0.8467   8.4821  6.2344
 Ridge  0.8466   8.4828  6.2349
 Lasso  0.8421   8.6123  6.3512

最佳模型: GAM
  R² Score: 0.8721
  RMSE: 7.75 μg/m³
  MAE: 5.78 μg/m³
```

## 📖 理解结果

### R² Score（决定系数）
- **0.87** 表示模型能解释87%的PM2.5变化
- **越接近1越好**
- 在真实数据上，R²通常在0.1-0.3之间（因为PM2.5受多种因素影响）

### RMSE（均方根误差）
- **7.75 μg/m³** 表示平均预测误差
- **越小越好**
- 可以理解为"预测值与实际值平均相差多少"

### MAE（平均绝对误差）
- **5.78 μg/m³** 表示绝对误差的平均值
- **越小越好**
- 比RMSE更稳健（不受极端值影响）

## 🎨 可视化解读

### 1. prediction_scatter.png
- **对角线**：理想预测线（预测=实际）
- **点的分布**：越靠近对角线，预测越准确
- **离散程度**：反映预测的稳定性

### 2. timeseries.png
- **黑色实线**：真实PM2.5浓度
- **彩色虚线**：各模型的预测
- **重合度**：线条越重合，预测越准

### 3. model_comparison.png
- **左图**：R²越高越好
- **中图**：RMSE越低越好
- **右图**：MAE越低越好

### 4. feature_importance.png
- **横条长度**：特征的重要程度
- **越长**：该气象因素对PM2.5影响越大

### 5. residuals.png
- **理想情况**：点随机分布在y=0两侧
- **如果有规律**：说明模型存在系统性偏差

## 🔧 使用真实数据

如果你有真实的气象和PM2.5数据：

### 方法1：修改数据路径

编辑 `MLR_GAM_Baseline.py`，修改第51-53行：

```python
pollution_all_path = r'你的路径\all(AQI+PM2.5+PM10)'
pollution_extra_path = r'你的路径\extra(SO2+NO2+CO+O3)'
era5_path = r'你的路径\ERA5-Beijing-CSV'
```

然后运行：
```bash
python MLR_GAM_Baseline.py
```

### 方法2：从CSV加载

如果你有处理好的CSV文件：

```python
# 在 MLR_GAM_Simple.py 中替换 generate_sample_data()
df = pd.read_csv('your_data.csv', index_col=0, parse_dates=True)
```

CSV格式应该是：
```
date,d2m,t2m,wind_speed_10m,tcwv,tp,blh,sp,str,tisr,month,season,PM2.5
2015-01-01,270.5,275.3,3.2,12.5,0.0,650.2,101200,185.3,220.1,1,1,85.3
...
```

## 💡 常见问题

### Q: 为什么模拟数据R²这么高？
**A:** 模拟数据是根据气象变量生成的，因此相关性很强。真实数据的R²通常在0.1-0.3。

### Q: GAM模型训练很慢？
**A:** GAM需要网格搜索最优参数，可以减少搜索范围：
```python
gam.gridsearch(X_train_scaled, y_train.values, lam=np.logspace(-2, 2, 5))
```

### Q: 想添加更多特征？
**A:** 在`features`列表中添加列名即可：
```python
features = ['d2m', 't2m', 'wind_speed_10m', ..., 'your_new_feature']
```

### Q: 想调整训练集/测试集比例？
**A:** 修改第XX行的split比例：
```python
split_idx = int(len(X) * 0.7)  # 改为70%训练，30%测试
```

## 📚 下一步学习

1. **理解特征**：阅读 `机器学习模型说明.md`
2. **查看相关性**：查看 `../Preprocessing-Correlation/` 目录
3. **尝试改进**：
   - 添加滞后特征（前一天的PM2.5）
   - 添加移动平均特征
   - 尝试特征交互（温度×湿度）
4. **进阶模型**：查看 `../DeepLearning/` 目录

## 🆘 遇到问题？

### 导入错误
```bash
ModuleNotFoundError: No module named 'xxx'
```
**解决**：
```bash
pip install xxx
```

### 数据路径错误
```
FileNotFoundError: [Errno 2] No such file or directory
```
**解决**：检查数据路径是否正确，或使用简化版（自动生成数据）

### 内存不足
```
MemoryError
```
**解决**：
1. 使用简化版
2. 减少数据量
3. 分批处理数据

## ✅ 完成清单

- [ ] 安装依赖
- [ ] 运行简化版脚本
- [ ] 查看生成的图表
- [ ] 理解评估指标含义
- [ ] 尝试调整参数
- [ ] 使用真实数据（可选）
- [ ] 阅读详细说明文档
- [ ] 尝试改进模型

---

**祝你成功！** 🎉

如有问题，请查看 `README.md` 和 `机器学习模型说明.md`

