# 机器学习基线模型 - 快速开始

## 概述

本目录包含基于气象变量预测北京PM2.5浓度的线性基线模型实现。

## 文件说明

### 1. MLR_GAM_Baseline.py （完整版）
- **用途**：使用真实数据进行完整的模型训练和评估
- **数据来源**：
  - 气象数据：ERA5再分析数据
  - 污染数据：北京市空气质量监测站数据
- **运行时间**：约10-30分钟（取决于数据量和硬件）
- **优点**：真实数据，结果可靠
- **缺点**：需要完整数据集，运行时间较长

### 2. MLR_GAM_Simple.py （简化版）⭐推荐入门使用
- **用途**：快速测试和理解模型原理
- **数据来源**：生成模拟数据（基于真实数据的统计特性）
- **运行时间**：约1-2分钟
- **优点**：快速、独立、易于理解
- **缺点**：使用模拟数据，仅供学习

### 3. 机器学习模型说明.md
- 详细的模型说明文档
- 包含理论背景、使用方法、评估指标等

## 快速开始

### 步骤1：安装依赖

```bash
pip install pandas numpy matplotlib seaborn scikit-learn scipy pygam
```

### 步骤2：运行简化版（推荐初学者）

```bash
python MLR_GAM_Simple.py
```

这将：
1. 生成2000天的模拟气象和PM2.5数据
2. 训练4种模型：MLR、Ridge、Lasso、GAM
3. 评估模型性能
4. 生成可视化图表
5. 保存结果文件

**预期输出：**
- 5个PNG图表文件
- 2个CSV结果文件
- 控制台显示详细的训练和评估信息

### 步骤3：运行完整版（需要真实数据）

```bash
python MLR_GAM_Baseline.py
```

**注意**：需要修改脚本中的数据路径为你的实际路径。

## 模型简介

### 1. 多元线性回归 (MLR)
最基础的线性模型，假设PM2.5与气象变量呈线性关系。

**公式：**
```
PM2.5 = β₀ + β₁·d2m + β₂·t2m + β₃·wind_speed + ... + ε
```

### 2. Ridge回归
带L2正则化的线性回归，防止过拟合。

**优势：**
- 缓解多重共线性
- 提高泛化能力

### 3. Lasso回归
带L1正则化的线性回归，可以进行特征选择。

**优势：**
- 自动特征选择（部分系数变为0）
- 模型更简洁

### 4. 广义加性模型 (GAM)
允许特征与目标变量之间存在非线性关系。

**公式：**
```
PM2.5 = β₀ + s₁(d2m) + s₂(t2m) + s₃(wind_speed) + ... + ε
```

其中s(·)是平滑样条函数。

## 特征说明

基于相关性分析结果，选择以下气象特征：

| 特征 | 中文名称 | 单位 | 物理意义 |
|------|----------|------|----------|
| d2m | 露点温度 | K | 反映空气湿度，影响污染物吸湿性 |
| t2m | 2米温度 | K | 影响大气稳定度和对流 |
| wind_speed_10m | 10米风速 | m/s | 影响污染物水平扩散 |
| tcwv | 总柱水汽 | kg/m² | 反映大气水汽含量 |
| tp | 降水量 | mm | 降水对污染物有清除作用 |
| blh | 边界层高度 | m | 影响污染物垂直扩散 |
| sp | 地面气压 | Pa | 反映大气环流形势 |
| str | 表面热辐射 | W/m² | 反映地表温度 |
| tisr | 太阳辐射 | W/m² | 影响光化学反应 |
| month | 月份 | - | 季节性特征 |
| season | 季节 | - | 季节性特征 |

## 评估指标

### R² Score (决定系数)
- **范围**：-∞ 到 1
- **含义**：模型解释目标变量方差的比例
- **理想值**：接近1

### RMSE (均方根误差)
- **单位**：μg/m³
- **含义**：预测误差的平方根平均值
- **理想值**：越小越好
- **特点**：对大误差敏感

### MAE (平均绝对误差)
- **单位**：μg/m³
- **含义**：预测误差的绝对值平均值
- **理想值**：越小越好
- **特点**：对所有误差一视同仁

## 输出文件说明

### CSV文件

1. **model_performance.csv / simple_model_performance.csv**
   - 各模型在训练集和测试集上的性能指标
   - 包含R²、RMSE、MAE

2. **predictions.csv**（仅完整版）
   - 测试集上的实际值和预测值
   - 可用于进一步分析

3. **feature_importance.csv / simple_coefficients.csv**
   - 各特征的回归系数
   - 反映特征对PM2.5的影响程度

### 图表文件

1. **prediction_scatter.png**
   - 预测值 vs 实际值散点图
   - 理想情况：点分布在对角线上

2. **prediction_timeseries.png**
   - 时间序列预测对比
   - 可视化模型的时序预测能力

3. **residuals_analysis.png**
   - 残差分析图
   - 检查模型假设是否满足

4. **feature_importance.png**
   - 特征重要性条形图
   - 显示各特征的相对重要性

5. **model_comparison.png**
   - 模型性能对比条形图
   - 直观比较各模型表现

## 典型结果

使用模拟数据的典型结果（仅供参考）：

| 模型 | R² | RMSE | MAE |
|------|-----|------|-----|
| MLR | 0.85 | 8.2 | 6.1 |
| Ridge | 0.85 | 8.2 | 6.1 |
| Lasso | 0.84 | 8.5 | 6.3 |
| GAM | 0.87 | 7.8 | 5.8 |

**注意**：真实数据的结果通常较低（R² < 0.3），因为PM2.5受多种复杂因素影响。

## 常见问题

### Q1: 为什么R²这么低？
**A:** PM2.5浓度受多种因素综合影响，包括：
- 气象条件（本模型考虑）
- 排放源强度（未考虑）
- 区域传输（未考虑）
- 化学反应（未考虑）

线性模型只能捕捉气象因素的线性影响，因此R²通常在0.1-0.3之间。

### Q2: GAM模型为什么更好？
**A:** GAM允许非线性关系，例如：
- 温度与PM2.5可能是U型关系
- 风速的影响可能非线性
- 降水量的清除效应可能存在阈值

### Q3: 如何改进模型？
**A:** 可以尝试：
1. **添加更多特征**：滞后特征、移动平均、交互项
2. **使用非线性模型**：随机森林、XGBoost、神经网络
3. **考虑时间依赖**：LSTM、GRU等时间序列模型
4. **集成学习**：模型融合、Stacking

### Q4: pygam安装失败怎么办？
**A:** 
```bash
# 方法1：使用conda
conda install -c conda-forge pygam

# 方法2：跳过GAM
# 脚本会自动检测并跳过GAM模型
```

## 下一步

完成基线模型后，可以：

1. **特征工程**：添加更多特征和交互项
2. **非线性模型**：尝试树模型和神经网络
3. **时间序列模型**：ARIMA、LSTM等
4. **空间模型**：考虑空间自相关
5. **集成学习**：模型融合

详见：`../DeepLearning/` 目录

## 参考资料

1. **相关性分析**：`../Preprocessing-Correlation/`
2. **深度学习模型**：`../DeepLearning/`
3. **模型说明**：`机器学习模型说明.md`

## 联系方式

如有问题，请参考：
- 项目GitHub（如有）
- 相关论文（如有）

---

**最后更新**：2025-10-07

